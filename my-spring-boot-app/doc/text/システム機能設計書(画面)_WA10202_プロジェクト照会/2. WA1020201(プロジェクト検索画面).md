# サンプルプロジェクト

## 1. PJ名
| No | 領域名 | ページング有無 | ソート条件 | 備考 |
|----|--------|----------------|------------|------|
| 1  | プロジェクト検索結果一覧 | 有 | プロジェクトID 昇順 | - |

## 2. 画面レイアウト
### 2.1. 画面項目定義
| No | 表示情報 | ドメイン名 | 【内部設計情報】 画面項目名（物理） |
|----|----------|------------|--------------------------------------|
| 1  | 事業部 | 組織ID | divisionId |
| 2  | 部門 | 組織ID | organizationId |
| 3  | PJ種別 | プロジェクト種別 | projectType |
| 4  | PJ分類 | プロジェクト分類 | projectClass |
| 5  | 売上高_実績_FROM (千円) | 金額 | salesFrom |
| 6  | 売上高_実績_TO (千円) | 金額 | salesTo |
| 7  | 開始日_FROM | 日付 | projectStartDateFrom |
| 8  | 開始日_TO | 日付 | projectStartDateTo |
| 9  | 終了日_FROM | 日付 | projectEndDateFrom |
| 10 | 終了日_TO | 日付 | projectEndDateTo |
| 11 | プロジェクト名で検索 | プロジェクト名 | projectName |

### 2.2. 一覧表示
| No | 領域名 | ページング有無 | ソート条件 | 備考 |
|----|--------|----------------|------------|------|
| 1  | プロジェクト検索結果一覧 | 有 | プロジェクトID 昇順 | - |

### 2.3. 画面項目定義
| No | 表示情報 | ドメイン名 | 【内部設計情報】 画面項目名（物理） |
|----|----------|------------|--------------------------------------|
| 1  | 事業部 | 組織ID | divisionId |
| 2  | 部門 | 組織ID | organizationId |
| 3  | PJ種別 | プロジェクト種別 | projectType |
| 4  | PJ分類 | プロジェクト分類 | projectClass |
| 5  | 売上高_実績_FROM (千円) | 金額 | salesFrom |
| 6  | 売上高_実績_TO (千円) | 金額 | salesTo |
| 7  | 開始日_FROM | 日付 | projectStartDateFrom |
| 8  | 開始日_TO | 日付 | projectStartDateTo |
| 9  | 終了日_FROM | 日付 | projectEndDateFrom |
| 10 | 終了日_TO | 日付 | projectEndDateTo |
| 11 | プロジェクト名で検索 | プロジェクト名 | projectName |

### 2.4. 入出力一覧
| No | 入出力名 | 種別 | I/O | DBアクセス種別 | 備考 |
|----|----------|------|-----|----------------|------|
| 1  | 組織 | テーブル | I | - | - |
| 2  | プロジェクト | テーブル | I | - | - |

### 2.5. 画面イベント一覧
| No | 画面イベント名 | 発生タイミング | 画面イベント概要 | 正常時遷移先画面 | サーバ通信有無 |
|----|----------------|----------------|------------------|------------------|----------------|
| 1  | 初期表示 | ‐ | プロジェクト検索画面を表示する。 | - | あり(同期) |
| 2  | 部門リスト取得 | 「事業部」プルダウン選択 | 選択された事業部をもとに、配下部門リストを「部門」プルダウンに設定する。 | - | あり(非同期) |
| 3  | 一覧検索 | 「検索」ボタン押下 | プロジェクト結果一覧を表示する。 | プロジェクト検索画面(結果表示） | あり(同期) |
| 4  | ページング | ページネーションリンク押下 | プロジェクト結果一覧を表示する。 | プロジェクト検索画面(結果表示） | あり(同期) |
| 5  | プロジェクト詳細表示 | 「PJ名」リンク押下 | プロジェクトIDをキーとしてプロジェクト1件のデータを検索し、詳細画面を表示する。 | プロジェクト詳細画面 | あり(同期) |

### 2.6. 画面イベント詳細
#### 2.6.1. 初期表示イベント
1. バリデーション処理
   - なし。
2. DBアクセス（検索処理）
   - 組織検索条件
     - 取得テーブル名: 組織
     - 取得カラム名: 組織ID, 組織名
     - 検索条件: 組織.上位組織ID = NULL
3. 表示処理
   - 「事業部」プルダウンを初期化する。
     - 「(2) 検索処理」の検索結果の先頭にブランクオプションを追加して、「事業部」に設定する。
     - プルダウンの表示項目には組織名を、値には組織IDを使用する。
   - 領域名：プロジェクト検索結果一覧は非表示とする。

#### 2.6.2. 部門リスト取得イベント
1. バリデーション処理
   - なし。
2. DBアクセス（検索処理）
   - 組織検索条件
     - 取得テーブル名: 組織
     - 取得カラム名: 組織ID, 組織名
     - 検索条件: 組織.上位組織ID = 事業部（入力値）
3. 表示処理
   - 「部門」プルダウンを初期化する。
     - 「(2) 検索処理」の検索結果の先頭にブランクオプションを追加して、「部門」に設定する。
     - プルダウンの表示項目には組織名を、値には組織IDを使用する。

#### 2.6.3. 一覧検索イベント
1. バリデーション処理
   - No. | バリデーション名 | バリデーション内容 | メッセージID | 埋め込み文字列 | エラー発生時のバリデーション処理継続判定 |
   |----|----------------|------------------|--------------|--------------|--------------------------------------|
   | 1  | 単項目バリデーション | 全ての入力項目に対して、指定ドメインに応じたバリデーションおよび必須チェックを実施し、入力内容の妥当性を確認する。 | （ドメイン別） | （ドメイン別） | 終了する |
   | 2  | 売上高大小関係 | 「売上高_実績_FROM」と「売上高_実績_TO」が両方入力されている場合、「売上高_実績_FROM」≦「売上高_実績_TO」であること。 | validator.priceRange.message | なし | 終了する |
   | 3  | 開始日大小関係 | 「開始日_FROM」と「開始日_TO」が両方入力されている場合、「開始日_FROM」≦「開始日_TO」であること。 | validator.dateRange.message | なし | 終了する |
   | 4  | 終了日大小関係 | 「終了日_FROM」と「終了日_TO」が両方入力されている場合、「終了日_FROM」≦「終了日_TO」であること。 | validator.dateRange.message | なし | 終了する |
   - 上記バリデーションにおいて一箇所でもエラーが発生した場合、後続の処理は実施しない。
2. DBアクセス（検索処理）
   - プロジェクト検索条件
     - 取得テーブル名: プロジェクト
     - 取得カラム名: プロジェクトID, プロジェクト名, プロジェクト種別, プロジェクト分類, プロジェクトマネージャー, 売上高, プロジェクト開始日付, プロジェクト終了日付
     - 結合条件: プロジェクト LEFT OUTER JOIN 組織 AS 部門 ON プロジェクト．組織ID = 部門．組織ID LEFT OUTER JOIN 組織 AS 事業部 ON 部門．上位組織ID = 事業部．組織ID
     - 検索条件: 事業部．組織ID = 事業部（入力値） AND 部門．組織ID = 部門（入力値） AND プロジェクト．プロジェクト種別 IN PJ種別（入力値） AND プロジェクト．プロジェクト分類 IN PJ分類（入力値） AND プロジェクト．売上高 ≧ 売上高_実績_FROM（入力値） AND プロジェクト．売上高 ≦ 売上高_実績_TO（入力値） AND プロジェクト．プロジェクト開始日付 ≧ 開始日_FROM（入力値） AND プロジェクト．プロジェクト開始日付 ≦ 開始日_TO（入力値） AND プロジェクト．プロジェクト終了日付 ≧ 終了日_FROM（入力値） AND プロジェクト．プロジェクト終了日付 ≦ 終了日_TO（入力値） AND プロジェクト．プロジェクト名 like %プロジェクト名で検索（入力値）%
     - ソート条件: ORDER BY プロジェクト．プロジェクトID
3. 表示処理
   - 「(2) 検索処理」の検索結果がない場合
     - 検索条件および検索結果なしエラーメッセージ(errors.nothing.search.project)を「プロジェクト検索画面(結果表示)」に表示し、領域名：プロジェクト検索結果一覧は非表示とする。
   - 「(2) 検索処理」の検索結果がある場合
     - 検索結果を「プロジェクト検索画面(結果表示)」に表示する。
     - 「検索」ボタン押下時は、1ページ目を表示する。

#### 2.6.4. ページングイベント
- 以下の条件でページ番号を指定して「2.6.3.一覧検索イベント」を行う。
  - 「<<」リンク：最初のページ
  - 「<」リンク：現在のページ数－1ページ
  - 「ページ番号」リンク：該当ページ番号
  - 「>」リンク：現在のページ数＋1ページ
  - 「>>」リンク：最後のページ

#### 2.6.5. プロジェクト詳細表示イベント
- 「3.WA1020202(プロジェクト詳細画面)：3.6.画面イベント詳細：3.6.1.初期表示イベント」を参照。